<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">

<style type="text/css">
.verde {
	color: green;
	front-size: 20px;
	padding: 10px;
}

.rosa {
	color: red;
	front-size: 20px;
	padding: 10px;
}

.azul {
	color: blue;
	front-size: 20px;
	padding: 10px;
}

.seleccionada {
	background-color: pink;
}
</style>

<title>Insert title here</title>
<script type="text/javascript" src="jquery-3.3.1.js"></script>

<script type="text/javascript">
	$(document).ready(
			function() {
			
				//1) Cargamos los libros en el body
				$.get("../ListaLibros.jsp?", function(datos){
					
					//alert(datos);
					$("body").append(datos);
					//AÃ±adirmos una tabla al body
					//La tabla se crea en ListaLibros.jsp donde se obtienen los datos
			
				
			
				
				
				//2)Recojemos el Libro de la tr donde se haga click
				$("tr").click(function() {
				
					$(this).find("td").each(function( index ) {
						  console.log( index + ": " + $( this ).text() );
						 if(index == 0){
							 
						   titulo = $(this).eq(0).text();
							console.log(index+ "--> " +titulo);
						 }
						
						});
			
					
				//3)Llamada ajax para obtener los capitulos
			var promesa =$.get("../MostrarCapitulosLibro.jsp?titulo="+titulo);

					console.log(promesa);
					
					
					//CUANDO LA PROMESA FINALIZA
			promesa.then(function(datos){
							
			
					console.log("llega promesa:",datos);

					datos = JSON.parse(datos.trim());
				
					console.log("JSON: ",datos);
					
				
           		
					for (var i = 0; i < datos.length; i++) {
						$("body")
								.append(
										"<p>" + datos[i].titulo
												+ ", "
												+ datos[i].paginas
												+ "</p>");
					}
					
				
			})
			
				})	
					
				})
				
				})
				
		
			
</script>
</head>
<body>


</body>
</html>



							
					
					
		
					

				